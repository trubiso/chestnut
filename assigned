@extern func print_integer(anon x: uint64);
@extern func putchar(c: char);

func fibonacci(count: uint64) {
	mut a = 0;  // set to const for error
	mut b = 1;
	mut i = 0;
'loop:
	i = i + 1;
	print_integer(a);
	putchar(' ');
	const c = a + b;
	a = b;
	b = c;
	if (i < count) goto 'loop;
}

/*
func skip_vardecl() {
	goto 'next;
'skip:
	const a: uint8;
'next:
	a = 3;
	const q = a;
}
*/

struct Test { field: bool }
struct Jest { field: uint8; test: Test }

func refs() {
	const my_immutable = 3;
	const mutable = &mut my_immutable;
	const struct = Jest { field: 8, test: Test { field: false } };
	const another = &mut struct.test.field;
	mut actual = Test { field: false };
	const cant = &mut *&const actual.field;
	const cant = &mut (*&const actual).field;
}

func move() {
	const a = 3;
	const b = a;
	const q = a;
}

@extern
func print_bool(anon _: bool);

@extern
func main() {
	const a: uint8 = 3;
	const b = undefined;
	b = 4;
	const test = Test { field: false };
	print_bool(test.field);
	const jest = Jest { field: 32, test: test };
	print_bool(jest.test.field);
	jest.field = 64;
	jest.test.field = true;
	print_bool(jest.test.field);
	jest.test.field = false;
	(*&const jest.test).field = true;
	print_bool(jest.test.field);
}
